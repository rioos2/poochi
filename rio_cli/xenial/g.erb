#!/bin/bash

mkdir -p .<%= @basic[:home]+"/"+@package[:package]+"/bin" %>

cd <%= @package[:package]+"/src/"+@package[:git_org]+"/aran" %>

# sometimes  the dependencies aren't getting pulled. Adding a master solved the problem.
git remote add master https://gitlab.com/rajesh_rajagopal/aran.git

sh support/linux/install_dev_0_ubuntu_latest.sh
sh support/linux/install_dev_9_linux.sh
. ~/.profile

make FLAGS=--release buildbin

CLI=linux_rioos_<%=Time.new.strftime("%Y%m%d%H%M%S")%>.tar.gz

tar -czvf $CLI target/release/rioos

# upload linux_rioos file to the github
github-release upload \
  --owner rioosdolphins \
  --repo rioos \
  --tag <%= @package[:cli_release_tag] %> \
  --name <%= @package[:cli_release_name] %> \
  --token <%= @package[:github_private_token] %>
  --body "This release contains fixes and  improvements for Rio OS CLI v2, Refer https://bit.ly/rioos_sh_userguide %>"  
  $CLI